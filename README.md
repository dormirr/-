# 简介

文本文件中单词的检索与计数

# 课题概述

编程建立一个文本文件，每个单词不包含空格且不跨行，单词由字符序列构成且区分大小写，统计给定单词在文本文件中出现的总次数，检索输出的某个单词出现在文本中的行号、在该行中出现的次数以及位置。

该设计要求可分三个部分实现：一是建立文本文件，文件名由用户键盘输入；二是给定单词的计数，输入一个不含空格的单词，统计输出该单词在文本中的出现次数；三是检索给定单词，检索并输出该单词所在的行号、该行中出现的次数以及在该行中的相应位置。

# 课题分析

本课题需要实现三个功能，一是建立文本文件，其中文件名由用户来输入；二是统计给定单词在文本文件中的数量；三是检索给定单词并输出所在行号、该行出现的次数以及在该行中的相应位置。

## 功能一

由用户输入文件名这个功能，只需要将文件的路径名提前保存到字符数组中，然后将用户输入的文件名放在之前保存路径的字符数组之后即可。

## 功能二

统计给定单词数量这个功能，只需要用strcmp函数将给定单词与从文本文件读取的单词比对，函数返回值为0则找到该单词，数量加一。但因为用户创建的文本中并没有内容，所以需要往用户创建的文本文件中输入内容。我将一个文本文件中的内容复制到用户创建的文件中，作为查询的对象。

## 功能三

功能三类似于功能二，只不过需要统计每行比对过的单词数量、行数、本行查找到的单词数和查找到的总单词数。每查询一行内容后，若找到过给定单词，就输出统计的数量。若没找到过就不用输出。然后清空统计的数量，只保留记录行数和查询到的总单词数这两个变量。

# 功能实现

## 文件结构

![img](/截图/clip_image001.jpg)

<center>图1 A题文件结构</center>

如图1所示，头文件夹中的custom.h是自定义的头文件，里面放着常用的头文件。

源文件夹的CopyFile.c中有CopyFile函数，是实现复制功能的函数代码；CreatFile.c中有CreatFile函数，是实现功能一的函数；Main.c中是主函数；OpenFile.c中有OpenFile函数，是实现打开用户创建的文件功能的函数；Retrieval.c中有Retrieval函数，是实现功能三的函数；WordCount.c中有WordCount函数是实现功能二的函数。

资源文件夹中放着用来提供内容的文本文档Decompression.txt。

## Main.c

Main.c中，放着主函数。主函数定义了文件指针fp和存放文件路径的字符数组file_name用来给其他功能提供参数，并通过while循环实现了一个菜单功能，来调用各个函数。每执行一个功能后都会关闭文件。

## CreateFile.c和OpenFile.c

CreateFile.c中，有一个名为CreateFile的函数，参数是字符数组file_name，返回值是文件指针类型。

首先初始化file_name数组，存入文件路径，如图2。

![img](/截图/clip_image003.png)

<center>图2 file_name数组初始化</center>

然后将用户输入的文件名存入该数组的\0及之后的位置，如图3。这样就保存好了文件的完整路径。

![img](/截图/clip_image005.png)

<center>图3 file_name数组最终保存的路径</center>

保存好完整路径后，就可以打开或创建以用户输入的文件名命名的文件了。打开后将文件指针fp返回。

OpenFile.c中有一个名为OpenFile的函数，参数是字符数组file_name，返回值是文件指针类型。

之前已经保存了文件的路径，放在file_name数组中。因为要多次打开该文件，所以写了这个函数。功能就是打开用户创建的文件，并返回文件指针。

## CopyFile.c

CopyFile.c中有一个名为CopyFile的函数，参数是文件指针，无返回值。

该函数是用来往用户创建的文件中添加内容的，添加的内容用来作为查询的对象。

该函数将存放在资源文件夹中的Decompression.txt打开，并将其中的内容存入文件指针所指向的位置。存入完毕后关闭了两个文件。

## WordCount.c

WordCount.c中有一个名为WordCount的函数，参数是文件指针，无返回值。

该函数用来实现功能二，统计给定单词数量。

首先由用户输入要查找的单词，存入find字符数组中。然后读入文件中的字符，遇到文件结尾结束。

读入的字符如果不是空格或者换行，就存入temp数组中。遇到空格或者换行则把’\0’存入temp数组，这样就是一个完整的字符串了。

通过strcmp(find,temp)进行对比，如果返回值是0，则找到了一个单词。

整个文件读完后，输出查找到的单词总数，然后关闭文件。这样就实现了功能二。

## Retrieval.c

Retrieval.c中有一个名为Retrieval的函数，参数是文件指针，无返回值。

该函数用来实现功能三，检索并输出给定单词所在的行号、该行中出现的次数以及在该行中的相应位置。

首先由用户输入要查找的单词，存入find字符数组中。然后读入文件中的字符，遇到文件结尾结束。

读入的字符如果不是空格或者换行，就存入temp数组中。

与WordCount函数不一样的地方是遇到空格或者换行则统计本行比对过的单词数变量加一，然后把’\0’存入temp数组，通过strcmp(find,temp)进行对比。如果strcmp(find,temp)函数返回值是0，则统计在本行找到的单词数和总共找到的单词数这两个变量加一，然后输出第几行，是本行找到的第几个，在哪个位置。

执行完之后，如果读入的字符是’\n’，则行数加一（初始行数变量的值是0），然后判断本行中有没有找到给定单词，如果找到了则输出在这行中共找到的单词数并将本行比对过的单词数和本行找到的单词数变量都置为0，如果没找到则不输出，只把两个变量置为0即可。

整个文件处理完成后，输出共在文件中找到的单词数。功能三就实现了。

# 运行截图

![img](/截图/clip_image007.jpg)

<center>图4 验证A题功能一</center>

 

![img](/截图/clip_image009.jpg)

<center>图5 A题功能一结果</center>

 

![img](/截图/clip_image011.jpg)

<center>图6 验证A题功能二与结果</center>

 

![img](/截图/clip_image013.jpg)

<center>图7 验证A题功能三与结果</center>

经过验证，所有功能全部实现并且运行正常。结果也全部正确。